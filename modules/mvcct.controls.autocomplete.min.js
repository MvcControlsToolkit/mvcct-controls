(function(){(function(){var l=this||(0,eval)("this");(function(f){if("function"===typeof define&&define.amd)define(["../mvcct.controls","../../mvcct-enhancer/mvcct.enhancer.min","../../awesomplete/awesomplete.min"],f);else if("object"===typeof exports&&"object"===typeof module)module.exports=f(require("../mvcct.controls"),require("mvcct-enhancer"),require("awesomplete"));else{var h=l.mvcct=l.mvcct||{};f(h.controls,h.enhancer,l.Awesomplete)}})(function(f,h,y){function t(a){var b=document.createEvent("HTMLEvents");
b.initEvent("blur",!0,!0);a.dispatchEvent(b);b=document.createEvent("HTMLEvents");b.initEvent("change",!0,!0);a.dispatchEvent(b);k&&k.validator&&(a=k(a),(b=a.closest("form").validate())&&b.element(a))}var n,k=l.jQuery,u={};h.register(null,null,function(a){a=a.serverWidgets||{};n=a.autocomplete||{}},"server autocomplete",null);f.addOperation("autocomplete_focus",function(a){var b=a.target,d=a.args;if(b.getAttribute("data-enhanced-autocomplete"))b.value="";else{b.setAttribute("data-enhanced-autocomplete",
"true");var c;for(c=b.nextSibling;c&&1!=c.nodeType;c=c.nextSibling);if(c){b.setAttribute("data-last-value",b.value);c.setAttribute("data-last-value",c.value);b.value="";var h="tolerate"==d[5];h&&(b._companion_display_=c);var z=h||"true"==d[5];a="function"===typeof n?n(target):n;var g,m=a.removeDiacritics?f.removeDiacritics:function(b){return b},v=f.removeDiacritics,p=u[d[2]],w=parseInt(d[4]),x=parseInt(d[3]);p||(u[d[2]]=p=new f.searchDictionary(d[0],w,x,a.maxCacheSize));var q=new y(b,{minChars:w,
maxItems:x,filter:function(b,a){b=m(b).toLowerCase();a=m(a).toLowerCase();return 0<=b.indexOf(a)},data:function(b){return{label:b[d[1]],value:b[d[1]]}}});b.parentNode.style.display="block";a=style=l.getComputedStyle(b);a.maxWidth&&(b.parentNode.style.maxWidth=a.maxWidth);a.minWidth&&(b.parentNode.style.minWidth=a.minWidth);a=function(a){if("keydown"==a.type){if(9!=(a.keyCode||a.which))return;if(g&&0<g.length)for(var f=m(b.value).toLowerCase(),r,e=0;e<g.length;e++)if(r=m(g[e][d[1]]).toLowerCase(),
0<=r.indexOf(f)){f!=r&&(b.value=g[e][d[1]],a.preventDefault());break}}a=c.value;if(g)for(e=0;e<g.length;e++)if(v(g[e][d[1]])==v(b.value)){e=g[e][d[0]];c.value=e;b.setAttribute("data-last-value",b.value);c.setAttribute("data-last-value",c.value);c.value!==a&&t(c);return}((e=z||!b.value)?function(){h||(b.value="")}:function(){b.value=b.getAttribute("data-last-value")})();a=c.value;e=e?"":c.getAttribute("data-last-value");c.value=e;c.value!==a?t(c):k&&k.validator&&(e=k(c),(a=e.closest("form").validate())&&
a.element(e))};b.addEventListener("blur",a,!1);b.addEventListener("keydown",a,!1);b.addEventListener("awesomplete-selectcomplete",a,!1);b.addEventListener("keyup",function(a){if(!(b.value.length<q.a)&&(a=a.keyCode||a.which,9!=a&&37!=a&&38!=a&&39!=a&&40!=a&&27!==a&&13!==a)){var c=m(b.value).toLowerCase();if(a=p.get(c))q.list=g=a;else{var d=new XMLHttpRequest;d.open("GET",b.getAttribute("data-url").replace(b.getAttribute("data-url-token"),b.value),!0);d.onload=function(){q.list=g=JSON.parse(d.responseText);
p.add(c,g)};d.send()}}},!1);setTimeout(function(){b.focus()})}}});return f})})()})();
