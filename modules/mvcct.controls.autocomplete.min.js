(function(){(function(){var l=this||(0,eval)("this");(function(e){if("function"===typeof define&&define.amd)define(["../mvcct.controls","../../mvcct-enhancer/mvcct.enhancer.min","../../awesomplete/awesomplete.min"],e);else if("object"===typeof exports&&"object"===typeof module)module.exports=e(require("../mvcct.controls"),require("mvcct-enhancer"),require("awesomplete"));else{var h=l.mvcct=l.mvcct||{};e(h.controls,h.enhancer,l.Awesomplete)}})(function(e,h,y){function t(a){var b=document.createEvent("HTMLEvents");
b.initEvent("blur",!0,!0);a.dispatchEvent(b);b=document.createEvent("HTMLEvents");b.initEvent("change",!0,!0);a.dispatchEvent(b);k&&k.validator&&(a=k(a),(b=a.closest("form").validate())&&b.element(a))}var n,k=l.jQuery,u={};h.register(null,null,function(a){a=a.serverWidgets||{};n=a.autocomplete||{}},"server autocomplete",null);e.addOperation("autocomplete_focus",function(a){var b=a.target,f=a.args;if(b.getAttribute("data-enhanced-autocomplete"))b.value="";else{b.setAttribute("data-enhanced-autocomplete",
"true");var c;for(c=b.nextSibling;c&&1!=c.nodeType;c=c.nextSibling);if(c){b.setAttribute("data-last-value",b.value);c.setAttribute("data-last-value",c.value);b.value="";var h="true"==f[5];a="function"===typeof n?n(target):n;var g,m=a.removeDiacritics?e.removeDiacritics:function(b){return b},v=e.removeDiacritics,p=u[f[2]],w=parseInt(f[4]),x=parseInt(f[3]);p||(u[f[2]]=p=new e.searchDictionary(f[0],w,x,a.maxCacheSize));var q=new y(b,{minChars:w,maxItems:x,filter:function(b,a){b=m(b).toLowerCase();a=
m(a).toLowerCase();return 0<=b.indexOf(a)},data:function(b){return{label:b[f[1]],value:b[f[1]]}}});b.parentNode.style.display="block";a=style=l.getComputedStyle(b);a.maxWidth&&(b.parentNode.style.maxWidth=a.maxWidth);a.minWidth&&(b.parentNode.style.minWidth=a.minWidth);a=function(a){if("keydown"==a.type){if(9!=(a.keyCode||a.which))return;if(g&&0<g.length)for(var e=m(b.value).toLowerCase(),r,d=0;d<g.length;d++)if(r=m(g[d][f[1]]).toLowerCase(),0<=r.indexOf(e)){e!=r&&(b.value=g[d][f[1]],a.preventDefault());
break}}a=c.value;if(g)for(d=0;d<g.length;d++)if(v(g[d][f[1]])==v(b.value)){d=g[d][f[0]];c.value=d;b.setAttribute("data-last-value",b.value);c.setAttribute("data-last-value",c.value);c.value!==a&&t(c);return}((d=h||!b.value)?function(){b.value=""}:function(){b.value=b.getAttribute("data-last-value")})();a=c.value;d=d?"":c.getAttribute("data-last-value");c.value=d;c.value!==a?t(c):k&&k.validator&&(d=k(c),(a=d.closest("form").validate())&&a.element(d))};b.addEventListener("blur",a,!1);b.addEventListener("keydown",
a,!1);b.addEventListener("awesomplete-selectcomplete",a,!1);b.addEventListener("keyup",function(a){if(!(b.value.length<q.a)&&(a=a.keyCode||a.which,9!=a&&37!=a&&38!=a&&39!=a&&40!=a&&27!==a&&13!==a)){var c=m(b.value).toLowerCase();if(a=p.get(c))q.list=g=a;else{var e=new XMLHttpRequest;e.open("GET",b.getAttribute("data-url").replace(b.getAttribute("data-url-token"),b.value),!0);e.onload=function(){q.list=g=JSON.parse(e.responseText);p.add(c,g)};e.send()}}},!1);setTimeout(function(){b.focus()})}}});return e})})()})();
