(function(){(function(){var p=this||(0,eval)("this");(function(e){if("function"===typeof define&&define.amd)define(["../mvcct.controls","./mvcct.controls.ajax","../../mvcct-enhancer/mvcct.enhancer.min"],e);else if("object"===typeof exports&&"object"===typeof module)module.exports=e(require("../mvcct.controls"),require("./mvcct.controls.ajax"),require("mvcct-enhancer"));else{var u=p.mvcct=p.mvcct||{};e(u.controls,u.controls,u.enhancer)}})(function(e,u,q){function v(a){var c=a.parentNode;r(a);a.parentNode.removeChild(a);
var b=a._expando_row_;a==c._expando_row_&&(c._expando_row_=null);b&&(a._expando_row_=null,r(b))}function p(a,c){var b=c.parentNode;c.parentNode.replaceChild(a,c);r(c);q.transform(a);c==b._expando_row_&&(b._expando_row_=null);if(b=c._expando_row_)c._expando_row_=null,r(b)}function w(a){if(a){var c=a.parentNode,b=a._expando_row_;a._expando_row_=null;a==c._expando_row_&&(c._expando_row_=null);e.clearErrors(a);b?(b._expando_row_=a,a.parentNode.replaceChild(b,a)):v(a)}}function A(a,c){if(a&&c){var b=a.parentNode;
w(b._expando_row_);a._expando_row_=null;c._expando_row_=a;b._expando_row_=c;a.parentNode.replaceChild(c,a)}}function J(a){for(;a&&a.getAttribute;a=a.parentNode)if("FORM"==a.tagName)return a;return null}function B(a,c){var b=a.row;if(b){var d=b.parentNode,f=J(b),h=null;f&&(f=f.querySelector('[name="__RequestVerificationToken"]'))&&(h=encodeURIComponent("__RequestVerificationToken")+"="+encodeURIComponent(f.value));var f=d.getAttribute("data-delete-confirmation"),n=d.getAttribute("data-delete-failed");
if(!f||confirm(f))c?(k(b),e.getContent(b,d.getAttribute("data-delete-url-"+b.getAttribute("data-row")).replace("_zzFzz_",b.getAttribute("data-key")),null,function(a){(a=JSON.parse(a))&&0<a.length?g(a[0].a[0]):v(b)},function(){return n},g,l,m,null,"POST",h)):v(b)}}function C(a,c){var b=a.row;if(b){var d=a.args,f=c&&null!=d&&0<d.length&&"add"==d[0],d=b.parentNode,h=d.getAttribute("data-modification-failed");f?(d._expando_row_==b&&(d._expando_row_=null),v(b)):c?w(b):(f=b._expando_row_)?A(b,f):(k(b),
e.getContent(b,d.getAttribute("data-edit-url-"+b.getAttribute("data-row")).replace("_zzFzz_",b.getAttribute("data-key")),null,function(a){if(a=e.parseHTML(a))A(b,a),q.transform(a)},function(){return h},g,l,m))}}function K(a){var c=a.row;if(c){a=c.parentNode;var b=a.getAttribute("data-modification-failed");e.postForm(c,a.getAttribute("data-add-url-"+c.getAttribute("data-row")),c.getAttribute("data-key")?"isAdd=False":"isAdd=True",function(a){(a=e.parseHTML(a))&&p(a,c)},function(){return b},g,l,m,k)}}
function x(a){var c=a.args;if(!c.length)return null;c=c[0];a.type=c;if("before"==c||"after"==c){c=a.find("data-row");if(!c)return null;a.row=c}c=a.control?a.control.getAttribute("id"):a.target.getAttribute("data-target");if(!c)return null;a.control=a.control||document.getElementById(c);c=document.getElementById(c+"_container");if(!c)return null;a.container=c;return a}function D(a,c){if(a){var b=a.row,d=a.args,f=a.type,d=1<d.length?d[1]:b?b.getAttribute("data-row"):"0";tRoot=a.container;d=tRoot.getAttribute("data-add-url-"+
d);c||(d=d.replace("_zzFzz_",tRoot.getAttribute("data-prefix")));var h=tRoot.getAttribute("data-add-failed");k(a.control);e.getContent(a.control,d,null,function(a){if(a=e.parseHTML(a))"before"==f?tRoot.insertBefore(a,b):"append"==f||"prepend"==f&&!tRoot.hasChildNodes()||"after"==f&&b==tRoot.lastChild?tRoot.appendChild(a):"prepend"==f?tRoot.insertBefore(a,tRoot.firstChild):"after"==f?tRoot.insertBefore(a,b.nextSibling):tRoot.appendChild(a),q.transform(a),c&&(w(tRoot._expando_row_),tRoot._expando_row_=
a)},function(){return h},g,l,m)}}function E(a,c){var b=a.row;if(b){var d=b.parentNode,f=d.getAttribute("data-modification-failed");k(a.control);var h=b.getAttribute("data-row"),n=d.getAttribute("data-edit-detail-url-"+h).replace("_zzFzz_",b.getAttribute("data-key"));c||(n=n.replace("_zzFzz_1",d.getAttribute("data-prefix")));e.getContent(a.control,n,null,function(c){var d=e.parseHTML(c);d&&(y(d,a.control.getAttribute("id")+"_detail",h),d.expando_onSubmit=function(a){(a=e.parseHTML(a))&&p(a,b);z(d)},
d.expando_onSubmitError=function(){return f})},function(){return f},g,l,m)}}function F(a){var c=a.row;if(c){var b=c.parentNode,d=b.getAttribute("data-record-not-found");k(a.control);var f=c.getAttribute("data-row"),c=b.getAttribute("data-show-url-"+f).replace("_zzFzz_",c.getAttribute("data-key"));e.getContent(a.control,c,null,function(b){(b=e.parseHTML(b))&&y(b,a.control.getAttribute("id")+"_detail",f)},function(){return d},g,l,m)}}function G(a,c){if(a){var b=a.row,d=a.args,f=a.type,h=1<d.length?
d[1]:b?b.getAttribute("data-row"):"0";tRoot=a.container;d=tRoot.getAttribute("data-add-detail-url-"+h);c||(d=d.replace("_zzFzz_",tRoot.getAttribute("data-prefix")));var n=tRoot.getAttribute("data-add-failed");k(a.control);e.getContent(a.control,d,null,function(d){var g=e.parseHTML(d);g&&(y(g,a.control.getAttribute("id")+"_detail",h),g.expando_onSubmit=function(a){if(a=e.parseHTML(a))"before"==f?tRoot.insertBefore(a,b):"append"==f||"prepend"==f&&!tRoot.hasChildNodes()||"after"==f&&b==tRoot.lastChild?
tRoot.appendChild(a):"prepend"==f?tRoot.insertBefore(a,tRoot.firstChild):"after"==f?tRoot.insertBefore(a,b.nextSibling):tRoot.appendChild(a),q.transform(a),c&&(w(tRoot._expando_row_),tRoot._expando_row_=a);z(g)},g.expando_onSubmitError=function(){return n})},function(){return n},g,l,m)}}var t,r,g,k,H,l,I,m,y,z;q.register(null,null,function(a){r=(a.ajax=a.ajax||{}).empty||function(a){a.innerHTML=""};a=a.serverWidgets=a.serverWidgets||{};var c=a.modal=a.modal||{};t=a.grid=a.grid||{};g=t.onError||function(a){alert(a)};
H=t.onStart||function(a){a.style.opacity="0.5"};I=t.onCompleted||function(a){a.removeAttribute("style")};m=t.onProgress||function(){};y=c.openModal;z=c.closeModal;k=function(a){a.setAttribute("data-frozen","true");H(a)};l=function(a){a.removeAttribute("data-frozen");I(a)}},"serverGrid",null);e.addOperation("save_click",function(a){var c=a.control;if(c){var b=a.find("data-version");b&&(b=b.firstChild,a=b.expando_onSubmit,b=b.expando_onSubmitError,a&&e.postForm(c,null,null,a,b,g,l,m,k))}},"server-detail",
!0);e.addOperation("close_click",function(a){a.control&&(a=a.find("data-version"))&&z(a)},"server-detail",!0);e.addOperation("delete_click",function(a){B(a,!0)},"server-immediate-grid");e.addOperation("delete_click",function(a){B(a,!1)},"server-batch-grid");e.addOperation("edit_click",function(a){C(a,!1)},"server-immediate-grid");e.addOperation("edit-detail_click",function(a){E(a,!0)},"server-immediate-grid");e.addOperation("edit-detail_click",function(a){E(a,!1)},"server-batch-grid");e.addOperation("undo_click",
function(a){C(a,!0)},"server-immediate-grid");e.addOperation("save_click",function(a){K(a)},"server-immediate-grid");e.addOperation("add_click",function(a){D(x(a),!0)},"server-immediate-grid");e.addOperation("add_click",function(a){D(x(a),!1)},"server-batch-grid");e.addOperation("add-detail_click",function(a){G(x(a),!0)},"server-immediate-grid",!0);e.addOperation("add-detail_click",function(a){G(x(a),!1)},"server-batch-grid",!0);e.addOperation("show-detail_click",function(a){F(a)},"server-immediate-grid");
e.addOperation("show-detail_click",function(a){F(a)},"server-batch-grid");return e})})()})();
