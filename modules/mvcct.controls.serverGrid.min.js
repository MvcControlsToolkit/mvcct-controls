(function(){(function(){var q=this||(0,eval)("this");(function(e){if("function"===typeof define&&define.amd)define(["../mvcct.controls.min","./mvcct.controls.ajax.min","../../mvcct-enhancer/mvcct.enhancer.min"],e);else if("object"===typeof exports&&"object"===typeof module)module.exports=e(require("../mvcct.controls.min"),require("./mvcct.controls.ajax.min"),require("mvcct-enhancer"));else{var t=q.mvcct=q.mvcct||{};e(t.controls,t.controls,t.enhancer)}})(function(e,t,p){function u(a){var c=a.parentNode;
k(a);a.parentNode.removeChild(a);var b=a._expando_row_;a==c._expando_row_&&(c._expando_row_=null);b&&(a._expando_row_=null,k(b))}function q(a,c){var b=c.parentNode;c.parentNode.replaceChild(a,c);k(c);p.transform(a);c==b._expando_row_&&(b._expando_row_=null);if(b=c._expando_row_)c._expando_row_=null,k(b)}function v(a){if(a){var c=a.parentNode,b=a._expando_row_;a._expando_row_=null;a==c._expando_row_&&(c._expando_row_=null);e.clearErrors(a);b?(b._expando_row_=a,a.parentNode.replaceChild(b,a)):u(a)}}
function z(a,c){if(a&&c){var b=a.parentNode;v(b._expando_row_);a._expando_row_=null;c._expando_row_=a;b._expando_row_=c;a.parentNode.replaceChild(c,a)}}function A(a,c){var b=a.row;if(b){var d=b.parentNode,f=d.getAttribute("data-delete-confirmation"),g=d.getAttribute("data-delete-failed");if(!f||confirm(f))c?(l(b),e.getContent(b,d.getAttribute("data-delete-url-"+b.getAttribute("data-row")).replace("_zzFzz_",b.getAttribute("data-key")),null,function(a){(a=JSON.parse(a))&&0<a.length?h(a[0].b[0]):u(b)},
function(){return g},h,m,n)):u(b)}}function B(a,c){var b=a.row;if(b){var d=a.args,f=c&&null!=d&&0<d.length&&"add"==d[0],d=b.parentNode,g=d.getAttribute("data-modification-failed");f?(d._expando_row_==b&&(d._expando_row_=null),u(b)):c?v(b):(f=b._expando_row_)?z(b,f):(l(b),e.getContent(b,d.getAttribute("data-edit-url-"+b.getAttribute("data-row")).replace("_zzFzz_",b.getAttribute("data-key")),null,function(a){if(a=e.parseHTML(a))z(b,a),p.transform(a)},function(){return g},h,m,n))}}function G(a){var c=
a.row;if(c){a=c.parentNode;var b=a.getAttribute("data-modification-failed");e.postForm(c,a.getAttribute("data-add-url-"+c.getAttribute("data-row")),c.getAttribute("data-key")?"isAdd=False":"isAdd=True",function(a){(a=e.parseHTML(a))&&q(a,c)},function(){return b},h,m,n,l)}}function w(a){var c=a.args;if(!c.length)return null;c=c[0];a.type=c;if("before"==c||"after"==c){c=a.find("data-row");if(!c)return null;a.row=c}c=a.control?a.control.getAttribute("id"):a.target.getAttribute("data-target");if(!c)return null;
a.control=a.control||document.getElementById(c);c=document.getElementById(c+"_container");if(!c)return null;a.container=c;return a}function C(a,c){if(a){var b=a.row,d=a.args,f=a.type,d=1<d.length?d[1]:b?b.getAttribute("data-row"):"0";tRoot=a.container;d=tRoot.getAttribute("data-add-url-"+d);c||(d=d.replace("_zzFzz_",tRoot.getAttribute("data-prefix")));var g=tRoot.getAttribute("data-add-failed");l(a.control);e.getContent(b,d,null,function(a){if(a=e.parseHTML(a))"before"==f?tRoot.insertBefore(a,b):
"append"==f||"prepend"==f&&!tRoot.hasChildNodes()||"after"==f&&b==tRoot.lastChild?tRoot.appendChild(a):"prepend"==f?tRoot.insertBefore(a,tRoot.firstChild):"after"==f?tRoot.insertBefore(a,b.nextSibling):tRoot.appendChild(a),p.transform(a),c&&(v(tRoot._expando_row_),tRoot._expando_row_=a)},function(){return g},h,m,n)}}function D(a,c){var b=a.row;if(b){var d=b.parentNode,f=d.getAttribute("data-modification-failed");l(b);var g=b.getAttribute("data-row"),k=d.getAttribute("data-edit-detail-url-"+g).replace("_zzFzz_",
b.getAttribute("data-key"));c||(k=k.replace("_zzFzz_1",d.getAttribute("data-prefix")));e.getContent(b,k,null,function(c){var d=e.parseHTML(c);d&&(x(d,a.control.getAttribute("id")+"_detail",g),d.expando_onSubmit=function(a){(a=e.parseHTML(a))&&q(a,b);y(d)},d.expando_onSubmitError=function(){return f})},function(){return f},h,m,n)}}function E(a){var c=a.row;if(c){var b=c.parentNode,d=b.getAttribute("data-record-not-found");l(c);var f=c.getAttribute("data-row"),b=b.getAttribute("data-show-url-"+f).replace("_zzFzz_",
c.getAttribute("data-key"));e.getContent(c,b,null,function(b){(b=e.parseHTML(b))&&x(b,a.control.getAttribute("id")+"_detail",f)},function(){return d},h,m,n)}}function F(a,c){if(a){var b=a.row,d=a.args,f=a.type,g=1<d.length?d[1]:b?b.getAttribute("data-row"):"0";tRoot=a.container;d=tRoot.getAttribute("data-add-detail-url-"+g);c||(d=d.replace("_zzFzz_",tRoot.getAttribute("data-prefix")));var k=tRoot.getAttribute("data-add-failed");l(a.control);e.getContent(b,d,null,function(d){var h=e.parseHTML(d);h&&
(x(h,a.control.getAttribute("id")+"_detail",g),h.expando_onSubmit=function(a){if(a=e.parseHTML(a))"before"==f?tRoot.insertBefore(a,b):"append"==f||"prepend"==f&&!tRoot.hasChildNodes()||"after"==f&&b==tRoot.lastChild?tRoot.appendChild(a):"prepend"==f?tRoot.insertBefore(a,tRoot.firstChild):"after"==f?tRoot.insertBefore(a,b.nextSibling):tRoot.appendChild(a),p.transform(a),c&&(v(tRoot._expando_row_),tRoot._expando_row_=a);y(h)},h.expando_onSubmitError=function(){return k})},function(){return k},h,m,n)}}
var r,k,h,l,m,n,x,y;p.register(null,null,function(a){k=(a.ajax||{}).empty||function(a){a.innerHTML=""};a=a.serverWidgets||{};var c=a.modal||{};r=a.grid||{};h=r.onError||function(a){alert(a)};l=r.onStart||function(){};m=r.onCompleted||function(){};n=r.onProgress||function(){};x=c.openModal||function(a,c,e){var g=document.getElementById(c);g?(g.firstChild.expando_onSubmit=null,g.firstChild.expando_onSubmitError=null,k(g),g.setAttribute("data-version",e),g.appendChild(a)):(g=document.createElement("DIV"),
g.setAttribute("id",c),g.setAttribute("data-version",e),g.appendChild(a),document.body.appendChild(g));p.transform(g);jQuery(a).modal({show:!1,a:"static"});a.getAttribute("data-destroy-on-close")&&jQuery(a).c("hidden.bs.modal",function(){a.expando_onSubmit=null;a.expando_onSubmitError=null;k(a.parentNode);a.parentNode.parentNode.removeChild(a.parentNode)});jQuery(a).modal("show")};y=c.closeModal||function(a){jQuery(a).modal("hide");a.expando_onSubmit=null;a.expando_onSubmitError=null}},"serverGrid",
null);e.addOperation("save_click",function(a){var c=a.control;if(c){var b=a.find("data-version");b&&(b=b.firstChild,a=b.expando_onSubmit,b=b.expando_onSubmitError,a&&e.postForm(c,null,null,a,b,h,m,n,l))}},"server-detail",!0);e.addOperation("close_click",function(a){a.control&&(a=a.find("data-version"))&&y(a)},"server-detail",!0);e.addOperation("delete_click",function(a){A(a,!0)},"server-immediate-grid");e.addOperation("delete_click",function(a){A(a,!1)},"server-batch-grid");e.addOperation("edit_click",
function(a){B(a,!1)},"server-immediate-grid");e.addOperation("edit-detail_click",function(a){D(a,!0)},"server-immediate-grid");e.addOperation("edit-detail_click",function(a){D(a,!1)},"server-batch-grid");e.addOperation("undo_click",function(a){B(a,!0)},"server-immediate-grid");e.addOperation("save_click",function(a){G(a)},"server-immediate-grid");e.addOperation("add_click",function(a){C(w(a),!0)},"server-immediate-grid");e.addOperation("add_click",function(a){C(w(a),!1)},"server-batch-grid");e.addOperation("add-detail_click",
function(a){F(w(a),!0)},"server-immediate-grid",!0);e.addOperation("add-detail_click",function(a){F(w(a),!1)},"server-batch-grid",!0);e.addOperation("show-detail_click",function(a){E(a)},"server-immediate-grid");e.addOperation("show-detail_click",function(a){E(a)},"server-batch-grid");return e})})()})();
